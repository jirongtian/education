package com.ntyx.vedu.controller;import com.ntyx.vedu.entity.User;import com.ntyx.vedu.mapper.UserMapper;import com.ntyx.vedu.service.UserService;import org.apache.commons.lang3.StringUtils;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.PostMapping;import java.util.Enumeration;/** * 使用邮箱登陆 目的: 唯一 * //1.查询数据库 * userService.findByEmail(email); * 1.1 根据邮箱 能查询到 表示有用户 * 1.2 没有查到   没有用户 * 1.3 根据查询的用户判断密码是否相等 如果相等 登陆成功 * 1.4 如果不相等 密码错误 * * userService.findByEmail(email , password); * 能查询到 登陆成功 * 查询不到 用户名或密码错误 * * 开发中 *      微信登陆 *      qq登陆 *      身份证登陆(政府机关单位) *      邮箱 *      短信登陆 * @return */@Controllerpublic class LoginSysController extends BaseController{    private static final Logger LOGGER = LoggerFactory.getLogger( LoginSysController.class);   /* @Autowired    private UserMapper userMapper;*/    @Autowired    private UserService userService;    @PostMapping(value = "/login", name = "登录")    public String login(String email,String password) {        if(StringUtils.isBlank(email)||StringUtils.isBlank(password))        {            request.setAttribute("error","用户名或密码不能为空");            return "forward:/login.jsp";        }        //User user=userMapper.findByEmail(email);        User user = userService.findByEmail(email);        LOGGER.info("当前用户："+user.getUserName());        if(user==null){            request.setAttribute("error","用户名错误");            return "forward:/login.jsp";        } else if(user!=null && !user.getPassword().equals(password)){//密码的情况            request.setAttribute("error", "密码错误" );            return "forward:/login.jsp";//此处携带数据        }else{            //3.有登陆成功 要将数据放入session中            session.setAttribute("loginUser" , user);            System.out.println("登陆成功");            //4.登陆成功后需要查询模块数据            //List<Module> modules = moduleService.findModuleByUid( user.getId() );            //一会页面显示需要            //session.setAttribute("modules" , modules);        }        return "home/main";    }     //退出    @GetMapping(value = "/logout",name="用户登出")    public String logout(){        //SecurityUtils.getSubject().logout();   //登出        Enumeration em = request.getSession().getAttributeNames();        while(em.hasMoreElements()){            request.getSession().removeAttribute(em.nextElement().toString());        }        return "forward:login.jsp";    }    @GetMapping(value = "/home",name = "跳转主页面")    public String home(){        return "home/home";    }}